
## ğŸ§  1. ì±…ì„ ì½ê¸° ì „ì—

í•œë²ˆë„ ì•ˆ í•´ë³¸ ê²ƒë“¤ì´ë¼.. í¥ë¯¸ë‹ì´ë„ê¹Œ!
ê¸°ì–µí•´ë‘ê³  ë‚˜ì¤‘ì— í•„ìš”í•  ë•Œ ì¼ìŒ ì¢‹ê² ë‹¤ëŠ” ë§ˆìŒìœ¼ë¡œ ì‹œì‘


---

## ğŸ“‚ 2. ë‚´ìš© ì •ë¦¬ (ìì‹ ì˜ ì–¸ì–´ë¡œ ìš”ì•½)

###  ğŸŒŸë„¤íŠ¸ì›Œí¬ IOì™€ CPU
#### ğŸ©¶ ë„¤íŠ¸ì›Œí¬ í†µì‹ 
```
outputStream.write(...)
inputStream.read(...)
```
- IO ëŒ€ê¸°ì‹œê°„ì„ ì¤„ì´ê³  CPU ì‚¬ìš©ë¥ ì„ ë†’ì´ì

#### ğŸ©¶ íŠ¸ë˜í”½ ì¦ê°€ì‹œ ìì› ë¬¸ì œ
1. IO ëŒ€ê¸°ë¡œ CPU ë‚­ë¹„
2. ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ìœ¼ë¡œ CPU ë‚­ë¹„
3. ìš”ì²­ë§ˆë‹¤ ìŠ¤ë ˆë“œ í• ë‹¹í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë†’ìŒ
- ê·¸ëŸ¬ë‚˜ ëŒ€ë¶€ë¶„ ì„œë¹„ìŠ¤ëŠ” ê±±ì • ë…¸ -> ê·¸ë§Œí¼ íŠ¸ë˜í”½ì´ ìˆê¸° ì „ì—, ë‹¤ë¥¸ ì´ìœ ë¡œ ì„±ëŠ¥ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥
- ê·¸ë§Œí¼ íŠ¸ë˜í”½ ìƒê¸°ë©´ ìƒê°í•˜ê¸°
    1. (ê²½ëŸ‰ìŠ¤ë ˆë“œ) ê°€ìƒ ìŠ¤ë ˆë“œ, ê³ ë£¨í‹´
    2. ë…¼ë¸”ë¡œí‚¹
    3. ë¹„ë™ê¸° IO

### ğŸŒŸ ê°€ìƒ ìŠ¤ë ˆë“œ

#### ğŸ©¶ JVMì€ ê°€ìƒ ìŠ¤ë ˆë“œë¥¼ ìŠ¤ì¼€ì¤„ë§í•œë‹¤. 
- í”Œë«í¼ ìŠ¤ë ˆë“œ: OSìŠ¤ë ˆë“œì— 1to1mapping ë˜í¼
- ê°€ìƒ ìŠ¤ë ˆë“œëŠ” ìˆ˜KB, ìˆ˜ë°±KB í™ ë©”ëª¨ë¦¬ ì‚¬ìš©
    - í˜¸ì¶œ ìŠ¤íƒ ê¹Šì´ì— ë”°ë¼ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ ë™ì ìœ¼ë¡œ ëŠ˜ë ¸ë‹¤ ì¤„ì„ ğŸˆ
```java
// 1. ê°€ìƒ ìŠ¤ë ˆë“œ ì‹œì‘ 
Thread.ofVirtual().start(() -> {
    // JVM: "ì¼ë‹¨ 2KBë§Œ ì¤„ê²Œ"
    method1();  // ë” í•„ìš”í•˜ë©´? JVM: "4KBë¡œ ëŠ˜ë ¤ì¤„ê²Œ"
    method2();  // ë” í•„ìš”í•˜ë©´? JVM: "8KBë¡œ ëŠ˜ë ¤ì¤„ê²Œ"
    method3();  // ë” í•„ìš”í•˜ë©´? JVM: "16KBë¡œ ëŠ˜ë ¤ì¤„ê²Œ"
    // methodë“¤ ëë‚˜ë©´? JVM: "ë‹¤ì‹œ 2KBë¡œ ì¤„ì¼ê²Œ"
});

// vs í”Œë«í¼ ìŠ¤ë ˆë“œ
new Thread(() -> {
    // OS: "ë¬´ì¡°ê±´ 1MB ì¤„ê²Œ" (ì‚¬ìš© ì•ˆí•´ë„)
    method1();  // ì—¬ì „íˆ 1MB
    method2();  // ì—¬ì „íˆ 1MB  
    method3();  // ì—¬ì „íˆ 1MB
});
```
- ëª‡ë°±ë°°ì˜ ë©”ëª¨ë¦¬ ì°¨ì´ê°€ ë‚¨
- ìƒì„±ì‹œê°„ë„ 100ë°° ì´ìƒ ì°¨ì´ ë‚¨
    - í”Œë«í¼ ìŠ¤ë ˆë“œ: 10ë§Œê°œ ìƒì„±ì— 21ì´ˆ!! ê°€ìƒ ìŠ¤ë ˆë“œëŠ” 0.2ì´ˆ 
- í†°ìº£ê°™ì€ ìš”ì²­ë³„ì“°ë ˆë“œ ìƒì„± ì„œë²„ì—ì„œ ê°€ìƒìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë” ì ì€ ë©”ëª¨ë¦¬ë¡œ ë§ì€ìš”ì²­ ì²˜ë¦¬ ê°€ëŠ¥!


#### ğŸ©¶ ê°€ìƒìŠ¤ë ˆë“œì˜ ë§ˆìš´íŠ¸ ì–¸ë§ˆìš´íŠ¸
- í•œ ê°œì˜ ìºë¦¬ì–´ ìŠ¤ë ˆë“œ(í”Œë«í¼ ìŠ¤ë ˆë“œ)ì— ê°€ìƒ ìŠ¤ë ˆë“œê°€ ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸ëœë‹¤.
- ê°€ìƒìŠ¤ë ˆë“œê°€ ì‹¤í–‰/ì‹¤í–‰ë©ˆì¶¤ê³¼ ê´€ë ¨ ìˆìŒ

#### ğŸ©¶ ì„±ëŠ¥ ìœ ì˜1
- ê°€ìƒìŠ¤ë ˆë“œê°€ ì‹¤í–‰ì¤‘ ë¸”ë¡œí‚¹ë˜ë©´ í”Œë«í¼ ìŠ¤ë ˆë“œì™€ ì–¸ë§ˆìš´íŠ¸ë¨ -> ê·¸ ê°€ìƒìŠ¤ë ˆë“œëŠ” ì‹¤í–‰ ë©ˆì¶¤
- ì–¸ë§ˆìš´íŠ¸ëœ í”Œë«í¼ ìŠ¤ë ˆë“œëŠ” ëŒ€ê¸°ì¤‘ì¸ ë‹¤ë¥¸ ê°€ìƒ ìŠ¤ë ˆë“œì™€ ë§ˆìš´íŠ¸ë¨
- ë¸”ë¡œí‚¹ ì—°ì‚° (IO, ReentrantLock, Thread.sleep()) ì—°ì‚°ì„ ë§Œë‚œ ê°€ìƒìŠ¤ë ˆë“œëŠ” ë¸”ë¡œí‚¹ë˜ê³ , í”Œë«í¼ìŠ¤ë ˆë“œëŠ” ëŒ€ê¸°ì¤‘ì¸ ë‹¤ë¥¸ ê°€ìƒìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰.
- ìë°”23 ì´ì „ì—ì„œëŠ” synchronizedë¡œ ë¸”ë¡œí‚¹ë˜ë©´ "í•´ë‹¹ ê°€ìƒ ìŠ¤ë ˆë“œê°€ ì–¸ë§ˆìš´íŠ¸ë˜ì§€ ì•ŠìŒ"
  => ì¦‰ ê°€ìƒìŠ¤ë ˆë“œ ë¸”ë¡œí‚¹ì¸ë° "í”Œë«í¼ ìŠ¤ë ˆë„ë„ ë¸”ë¡œí‚¹ ë¨!"
  => "ê°€ìƒ ìŠ¤ë ˆë“œê°€ í”Œë«í¼ ìŠ¤ë ˆë“œì— ê³ ì •ëë‹¤ (pinned)"
  => ìë°” 21 ê¸°ì¤€ìœ¼ë¡œ JNI í˜¸ì¶œ ë˜í•œ pinned ê°€ëŠ¥
  => ì´ë ‡ê²Œ ê°€ìƒìŠ¤ë ˆë“œê°€ pinned -> CPU íš¨ìœ¨ ë†’ì¼ ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì„ ìœ ì˜ 

#### ğŸ©¶ ì„±ëŠ¥ ìœ ì˜2
- í”Œë«í¼ ìŠ¤ë ˆë“œë³´ë‹¤ ê°€ìƒìŠ¤ë ˆë“œê°€ ë” ë§ì•„ì•¼ ì´ì ì„ ëˆ„ë¦¼..
  1. ì§€ê¸ˆ ì½”ì–´ë¡œ ì»¤ë²„ë˜ë©´ êµ³ì´ ì ìš© X
  2. íŠ¸ë˜í”½ì´ ë§ì•„ì§€ë©´ ì ìš©í•˜ì„¸ìš”


### ğŸŒŸ ë…¼ë¸”ë¡œí‚¹ IO
#### ğŸ©¶ ê°œìš”
- ê²½ëŸ‰ ìŠ¤ë ˆë“œë¡œë„ í•œê³„ê°€ ì™”ë‹¤ë©´? ë…¼ë¸”ë¡œí‚¹ IOë¥¼ ì‚¬ìš©í•˜ë„ë¡ êµ¬ì¡°ì  ë³€ê²½ í•´ì•¼ í•¨
- ì˜¤ë˜ ì „ë¶€í„° network ì„œë²„ ì„±ëŠ¥ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë°©ì‹ (nginx, netty, node.js...)
- ë°ì´í„° ì½ì„ë–„ê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ë¸”ë¡œí‚¹ IOì™€ëŠ” ë‹¤ë¥´ë‹¤. ì½ì„ê±° ì—†ìŒ 0 ë¦¬í„´
- ë£¨í”„ ì•ˆì—ì„œ ì¡°íšŒë¥¼ ë°˜ë³µí•´ í˜¸ì¶œí•œ ë’¤ ë°ì´í„°ë¥¼ ì½ì—ˆì„ ë•Œë§Œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„. ë£¨í”„ ì•ˆì—ì„œ ì–´ë–¤ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸ í›„, í•´ë‹¹ ì—°ì‚° ì‹¤í–‰. 
- Event Loop íŒ¨í„´: í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ì—¬ëŸ¬ ì—°ê²°ì„ ìˆœíšŒí•˜ë©´ì„œ "ì§€ê¸ˆ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì¼"ë§Œ ê³¨ë¼ì„œ ì²˜ë¦¬
- í´ë¼ì´ì–¸íŠ¸ ìˆ˜ ìƒê´€ì—†ì´ ì†Œìˆ˜ì˜ ìŠ¤ë ˆë“œ ì‚¬ìš© (thread per reqê³¼ëŠ” ë‹¬ë¦¬!) ë™ì ‘ í´ë¼ì´ì–¸íŠ¸ê°€ ì¦ê°€í•´ë„ ìŠ¤ë ˆë“œ ê°œìˆ˜ ì¼ì • ìœ ì§€. ë” ë§ì€ í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ
=> ì–´ë–»ê²Œ? 
- ë³´í†µ CPU ê°œìˆ˜ë§Œí¼ ê·¸ë£¹ì„ ë‚˜ëˆ„ê³ , ê° ê·¸ë£¹ë§ˆë‹¤ ì…ì¶œë ¥ì„ ì²˜ë¦¬í•  ìŠ¤ë ˆë“œë¥¼ í• ë‹¹í•œë‹¤
> ìŠ¤ë ˆë“œ 1ê°œ = ì—°ê²° 1ê°œ: 1000ê°œ ì—°ê²° = 1000ê°œ ìŠ¤ë ˆë“œ (ë©”ëª¨ë¦¬ ë¶€ì¡±!)  
> ìŠ¤ë ˆë“œ Nê°œ = ì—°ê²° ìˆ˜ì²œê°œ: CPU ì½”ì–´ ìˆ˜ë§Œí¼ ìŠ¤ë ˆë“œë¡œ ìˆ˜ì²œê°œ ì—°ê²° ì²˜ë¦¬
```java
// Netty EventLoop ì˜ˆì œ - CPU ê°œìˆ˜ë§Œí¼ ê·¸ë£¹ ë¶„í• .. 
EventLoopGroup bossGroup = new NioEventLoopGroup(1); // Boss Group: ìƒˆë¡œìš´ ì—°ê²° accept() ë‹´ë‹¹ 

EventLoopGroup workerGroup = new NioEventLoopGroup(); // Worker Group: ì‹¤ì œ ë°ì´í„° ì²˜ë¦¬ ë‹´ë‹¹ (CPU ê°œìˆ˜ë§Œí¼)
// [Selector Thread 1] â†’ SocketChannel ê·¸ë£¹ 1 ë‹´ë‹¹
// [Selector Thread 2] â†’ SocketChannel ê·¸ë£¹ 2 ë‹´ë‹¹
// [Selector Thread 3] â†’ SocketChannel ê·¸ë£¹ 3 ë‹´ë‹¹
// [Selector Thread 4] â†’ SocketChannel ê·¸ë£¹ 4 ë‹´ë‹¹ (4ì½”ì–´ ê¸°ì¤€)

ServerBootstrap b = new ServerBootstrap();
b.group(bossGroup, workerGroup)
 .channel(NioServerSocketChannel.class)
 .childHandler(new ChannelIintializer<SocketChannel>() {
    @Override
    public void initChannel(SocketChannel ch) {
        ch.pipline().addLast(new EchoServerHandler());
    }
 })
```

```java
// 4ê°œ ìŠ¤ë ˆë“œê°€ 1000ê°œ ì—°ê²°ì„ ë‚˜ëˆ ì„œ ë‹´ë‹¹
// selector.select()ë¡œ 250ê°œ ì—°ê²°ì„ ë™ì‹œì— ëª¨ë‹ˆí„°ë§í•˜ê³ , ì¤€ë¹„ëœ ê²ƒë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì²˜ë¦¬
// 1ê°œ ìŠ¤ë ˆë“œê°€ 250ê°œ ì—°ê²°ì„ ë‹´ë‹¹: CPUì˜ ë©€í‹°íƒœìŠ¤í‚¹ì²˜ëŸ¼, ì‹œë¶„í• ë¡œ ë§¤ìš° ë¹ ë¥´ê²Œ ìˆœí™˜í•˜ë©° ì²˜ë¦¬í•˜ëŠ” ê°œë…
Worker-1: 250ê°œ ì—°ê²°ì„ ìˆœí™˜í•˜ë©° ì²˜ë¦¬ (í•­ìƒ ë°”ì¨)
Worker-2: 250ê°œ ì—°ê²°ì„ ìˆœí™˜í•˜ë©° ì²˜ë¦¬ (í•­ìƒ ë°”ì¨)  
Worker-3: 250ê°œ ì—°ê²°ì„ ìˆœí™˜í•˜ë©° ì²˜ë¦¬ (í•­ìƒ ë°”ì¨)
Worker-4: 250ê°œ ì—°ê²°ì„ ìˆœí™˜í•˜ë©° ì²˜ë¦¬ (í•­ìƒ ë°”ì¨)

// ì¥ì :
// 1. 4ê°œ ìŠ¤ë ˆë“œ = 4MB ë©”ëª¨ë¦¬
// 2. ìŠ¤ë ˆë“œë“¤ì´ í•­ìƒ ì¼ì„ í•¨ (CPU íš¨ìœ¨ì„± ê·¹ëŒ€í™”)
// 3. ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ìµœì†Œí™”
```
```java
// IOì²˜ë¦¬í•˜ëŠ” ì—°ì‚° ê°€ëŠ¥? <- êµ¬ì²´ì  ì˜ˆì‹œ.. 
// Worker-1ì´ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤
public class EventLoopExample {
    
    // Worker-1 ìŠ¤ë ˆë“œì˜ ì‹¤ì œ ì²˜ë¦¬ ê³¼ì •
    public void workerThreadLoop() {
        Selector selector = this.selector;
        
        while (true) {
            // 1. 250ê°œ ì—°ê²° ì¤‘ ì¤€ë¹„ëœ ê²ƒë“¤ í™•ì¸ (ë…¼ë¸”ë¡œí‚¹)
            int events = selector.select(1); // ìµœëŒ€ 1ms ëŒ€ê¸°
            
            if (events > 0) {
                Set<SelectionKey> keys = selector.selectedKeys();
                
                for (SelectionKey key : keys) {
                    if (key.isReadable()) {
                        // client42ì—ì„œ "Hello" ë©”ì‹œì§€ ë„ì°©
                        SocketChannel ch = (SocketChannel) key.channel();
                        ByteBuffer buffer = ByteBuffer.allocate(1024);
                        int bytesRead = ch.read(buffer); // ë…¼ë¸”ë¡œí‚¹!
                        
                        if (bytesRead > 0) {
                            // ë¹ ë¥¸ ì²˜ë¦¬ (1ms ì´ë‚´)
                            processMessage(buffer);
                            // client42 ì²˜ë¦¬ ì™„ë£Œ!
                        }
                    }
                    
                    if (key.isWritable()) {
                        // client156ì´ ì‘ë‹µ ë°›ì„ ì¤€ë¹„ë¨
                        SocketChannel ch = (SocketChannel) key.channel();
                        ByteBuffer response = getResponse();
                        ch.write(response); // ë…¼ë¸”ë¡œí‚¹!
                        // client156 ì²˜ë¦¬ ì™„ë£Œ!
                    }
                }
                keys.clear();
            }
            
            // 2. ì¦‰ì‹œ ë‹¤ì‹œ ë£¨í”„ â†’ ë‹¤ë¥¸ ì—°ê²°ë“¤ í™•ì¸
            // ì´ ê³¼ì •ì´ ë§¤ìš° ë¹ ë¥´ê²Œ ë°˜ë³µë¨ (ë§ˆì´í¬ë¡œì´ˆ ë‹¨ìœ„)
        }
    }
}
```
- ìƒˆ í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë  ë•Œë§ˆë‹¤ bossê°€ accept() ì²˜ë¦¬, ìƒˆë¡œìš´ SocketChannelì„ Worker ì¤‘ í•˜ë‚˜ì— ë¼ìš´ë“œë¡œë¹ˆ í• ë‹¹, í•´ë‹¹ Workerê°€ ê·¸ ì—°ê²°ì˜ ëª¨ë“  IOë¥¼ ì „ë‹´. 

- ì ˆëŒ€ê¸ˆì§€ì‚¬í•­
```java
@Override
public void channelRead(ChannelHandlerContext ctx, Object msg) {
    // EventLoop ë¸”ë¡œí‚¹ - ë‹¤ë¥¸ ëª¨ë“  ì—°ê²°ì´ ë©ˆì¶¤!
    Thread.sleep(1000);
    // ë™ê¸° DB í˜¸ì¶œ
    // íŒŒì¼ I/O
    // HTTP í˜¸ì¶œ
}
```
- ë¬´ê±°ìš´ ì‘ì—…ì€ ë³„ë„ ìŠ¤ë ˆë“œí’€ë¡œ ìœ„ì„í•˜ê¸°. Future ì‚¬ìš©.. 
```java
@Override
public void channelRead(ChannelHandlerContext ctx, Object msg) {
    // 1. ì‘ì—…ì„ ë³„ë„ ìŠ¤ë ˆë“œí’€ë¡œ ìœ„ì„
    CompletableFuture.supplyAsync(() -> {
        return heavyWork(msg); // ë¬´ê±°ìš´ ì‘ì—…
    }, customThreadPool)
    .thenAccept(result -> {
        // 2. ê²°ê³¼ë¥¼ EventLoopë¡œ ë‹¤ì‹œ ëŒë ¤ì¤Œ
        ctx.channel().eventLoop().execute(() -> {
            ctx.writeAndFlush(result);
        });
    });
}
```
- í•µì‹¬ì€ EventLoopë¥¼ ì ˆëŒ€ ë¸”ë¡œí‚¹í•˜ì§€ ì•ŠëŠ” ê²ƒ


#### ğŸ©¶ ì…€ë ‰í„°
- NIO ë„Œë¸”ë¡œí‚¹ì˜ í•µì‹¬ ê°ì²´ëŠ” ë©€í‹°í”Œë ‰ì„œì¸ Selectorì…ë‹ˆë‹¤. ì…€ë ‰í„°ëŠ” ë³µìˆ˜ ê°œì˜ ì±„ë„ ì¤‘ì—ì„œ `ì´ë²¤íŠ¸ê°€ ì¤€ë¹„ ì™„ë£Œëœ ì±„ë„ì„ ì„ íƒ`í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤
- Selectorì˜ select() ë©”ì„œë“œëŠ” IOì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ì—°ì‚°ì´ ì¡´ì¬í•  ë•Œê¹Œì§€ ëŒ€ê¸°í•œë‹¤..
- ì‹¤í–‰ ê°€ëŠ¥í•œ ì—°ì‚° ëª©ë¡ì€ selectedKeys()ë¡œ ì£„íšŒ ê°€ëŠ¥. ì–´ë–¤ì—°ì‚°ì´ ã„±ã„´í•œì§€ í™•ì¸í•˜ê³ , í•´ë‹¹ ì—°ì‚° ìˆ˜í–‰. 

#### ğŸ©¶ ë¦¬ì•¡í„° íŒ¨í„´
- ë™ì‹œì„±ì„ ë‹¤ë£¨ëŠ” ë””ìì¸ íŒ¨í„´ ì¤‘ í•˜ë‚˜, `êµ¬ì„±ì€ "ë¦¬ì•¡í„°", "í•¸ë“¤ëŸ¬"`
- ë¦¬ì•¡í„°ê°€ ì´ë²¤íŠ¸ ë°œìƒ ëŒ€ê¸°í•˜ê³ , ë°œìƒì‹œ ì ì ˆí•œ í•¸ë“¤ëŸ¬ë¡œ ë³´ë‚´ê³ , ì´ë²¤íŠ¸ë¥¼ ë°›ì€ í•¸ë“¤ëŸ¬ê°€ ë¡œì§ ìˆ˜í–‰
- ê·¸ ê³¼ì • ìì²´ê°€ ì´ë²¤íŠ¸ ë£¨í”„

#### ğŸ©¶ ì¤„ ë‹¨ìœ„ ì„œë²„ ìˆ˜ì‹  êµ¬í˜„
- ë¦¬ì•¡í„° ë„¤í‹°ë¥¼ í†µí•´ ë…¼ë¸”ë¡œí‚¹ IOë¥¼ ì‰½ê²Œ êµ¬í˜„ ê°€ëŠ¥ (ì¤„ë‹¨ìœ„ ì½ê¸°, ë¬¸ìì—´ ë³€í™˜ ì²˜ë¦¬ ê¸°ëŠ¥ ì œê³µ)
- ìŠ¤í”„ë§ ë¦¬ì•¡í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•¨. ì´ê±° ìµìˆ™í•´ì§€ë©´ ê°„ë‹¨íˆ êµ¬í˜„ ê°€ëŠ¥í•´ì§

#### ğŸ©¶ ì„±ëŠ¥
- ì±…ì—ì„œëŠ” JVMê¸°ì¤€ ë™ì ‘ ìˆ˜ 20ë°° í–¥ìƒ í™•ì¸í•¨. 


---

## ğŸ’¬ 3. ì´ì•¼ê¸°í•˜ê³  ì‹¶ì€ ì§ˆë¬¸ / í¬ì¸íŠ¸ &&  ğŸ¯ 4. ì •ë¦¬ & ì ìš© ì•„ì´ë””ì–´


```
// ì „í†µì ì¸ ë°©ì‹
ìŠ¤íƒ ì˜ì—­ = {
    ë©”ì„œë“œ í”„ë ˆì„ë“¤,
    ì§€ì—­ ë³€ìˆ˜ë“¤
} â†’ GCê°€ ê´€ë¦¬ ì•ˆí•¨, ë©”ì„œë“œ ëë‚˜ë©´ ìë™ ì‚¬ë¼ì§

// ê°€ìƒ ìŠ¤ë ˆë“œ ë°©ì‹  
í™ ì˜ì—­ = {
    ì¼ë°˜ ê°ì²´ë“¤,
    + ìŠ¤íƒ ì²­í¬ ê°ì²´ë“¤  â† ì´ê²Œ ìƒˆë¡œì›€!
} â†’ GCê°€ ë‹¤ ê´€ë¦¬í•¨
```

### ğŸ” **ì‹¤ë¬´ ì ìš© ì‚¬ë¡€: ë¡œê·¸ì„œì¹˜ ìµœì í™”**

í˜„ì¬ ì§„í–‰ ì¤‘ì¸ log-search í”„ë¡œì íŠ¸ì˜ ì‹¤ì œ ì½”ë“œë¥¼ ë¶„ì„í•˜ë‹ˆ, 7ì¥ì—ì„œ ë°°ìš´ IO ë³‘ëª© í•´ê²° ê¸°ë²•ë“¤ì„ ì ìš©í•  ìˆ˜ ìˆëŠ” **ì „í˜•ì ì¸ ë¸”ë¡œí‚¹ IO ì‚¬ë¡€**ë¥¼ ë°œê²¬í–ˆë‹¤.

#### **í˜„ì¬ êµ¬í˜„ì˜ ë¸”ë¡œí‚¹ ì§€ì  ë¶„ì„**

**executeCommand() ë©”ì„œë“œì˜ ë¸”ë¡œí‚¹ íŒ¨í„´:**
```java
// ì‹¤ì œ ì½”ë“œ (line 147-167)
private String executeCommand(String command) {
    // 1. í”„ë¡œì„¸ìŠ¤ ìƒì„± ë¸”ë¡œí‚¹
    ProcessBuilder processBuilder = new ProcessBuilder(cmd);
    Process process = processBuilder.start();
    
    // 2. í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ ëŒ€ê¸° ë¸”ë¡œí‚¹  
    boolean completed = process.waitFor(config.getCommandTimeout(), TimeUnit.MILLISECONDS);
    
    // 3. ê²°ê³¼ ì½ê¸° ë¸”ë¡œí‚¹
    try (BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()))) {
        String line;
        while ((line = reader.readLine()) != null) { // ê° ë¼ì¸ë§ˆë‹¤ ë¸”ë¡œí‚¹
            result.append(line).append(System.lineSeparator());
        }
    }
}
```

**getLogFiles() ë©”ì„œë“œì˜ ìˆœì°¨ ì²˜ë¦¬:**
```java
// ì‹¤ì œ ì½”ë“œ (line 52-62)
for (String path : serverPaths) {
    try {
        List<String> filesInPath = systemCommandService.getFileList(path); // ê° ê²½ë¡œë§ˆë‹¤ ë¸”ë¡œí‚¹
        allFiles.addAll(filesInPath);
    } catch (Exception e) {
        // í•˜ë‚˜ ì‹¤íŒ¨í•˜ë©´ ë‹¤ìŒê¹Œì§€ ì§€ì—°
    }
}
```

#### **7ì¥ ì´ë¡  ê¸°ë°˜ ìµœì í™” ë°©ì•ˆ**

**ğŸš€ ê°€ìƒ ìŠ¤ë ˆë“œ ì ìš©**: ì—¬ëŸ¬ ì„œë²„ ê²½ë¡œë¥¼ ë³‘ë ¬ë¡œ ì²˜ë¦¬
```java
// Before: ìˆœì°¨ ë¸”ë¡œí‚¹ ì²˜ë¦¬ (í˜„ì¬ ì½”ë“œ)
for (String path : serverPaths) {
    List<String> filesInPath = systemCommandService.getFileList(path);
    allFiles.addAll(filesInPath);
}

// After: ê°€ìƒ ìŠ¤ë ˆë“œ ë³‘ë ¬ ì²˜ë¦¬
try (var executor = Executors.newVirtualThreadPerTaskExecutor()) {
    List<CompletableFuture<List<String>>> futures = serverPaths.stream()
        .map(path -> CompletableFuture.supplyAsync(
            () -> systemCommandService.getFileList(path), executor))
        .collect(Collectors.toList());
    
    // ê° ê²½ë¡œì˜ IO ëŒ€ê¸° ì¤‘ ë‹¤ë¥¸ ê²½ë¡œ ì²˜ë¦¬ ê°€ëŠ¥
    for (CompletableFuture<List<String>> future : futures) {
        allFiles.addAll(future.get());
    }
}
```

**âš¡ ë…¼ë¸”ë¡œí‚¹ IO ì ìš©**: grep í”„ë¡œì„¸ìŠ¤ ì œê±°í•˜ê³  Java NIO ì§ì ‘ ì‚¬ìš©
```java
// Before: í”„ë¡œì„¸ìŠ¤ ìƒì„± + íŒŒì´í”„ í†µì‹  (í˜„ì¬ ì½”ë“œ)
String grepCommand = buildGrepCommand(filePath, keywords, searchType);
Process process = processBuilder.start(); // í”„ë¡œì„¸ìŠ¤ ìƒì„± ë¸”ë¡œí‚¹
BufferedReader reader = new BufferedReader(...); // ìˆœì°¨ ì½ê¸° ë¸”ë¡œí‚¹

// After: NIO ë¹„ë™ê¸° íŒŒì¼ ì½ê¸°
AsynchronousFileChannel fileChannel = AsynchronousFileChannel.open(Paths.get(filePath));
ByteBuffer buffer = ByteBuffer.allocate(8192);

fileChannel.read(buffer, 0, buffer, new CompletionHandler<Integer, ByteBuffer>() {
    @Override
    public void completed(Integer result, ByteBuffer attachment) {
        // ë¹„ë™ê¸°ë¡œ íŒ¨í„´ ë§¤ì¹­ ìˆ˜í–‰
        String content = new String(attachment.array(), 0, result);
        // grep ì—†ì´ Java ì •ê·œì‹ìœ¼ë¡œ í•„í„°ë§
    }
});
```

**ğŸ“Š ì˜ˆìƒ ì„±ëŠ¥ ê°œì„  íš¨ê³¼:**
- **í˜„ì¬(ê°€ì •)**: 5ê°œ ì„œë²„ ê²½ë¡œ Ã— í‰ê·  2ì´ˆ = 10ì´ˆ ì†Œìš”
- **ê°€ìƒ ìŠ¤ë ˆë“œ ì ìš©**: IO ë³‘ë ¬ ì²˜ë¦¬ë¡œ 2-3ì´ˆë¡œ ë‹¨ì¶• (3-5ë°° ê°œì„ )
- **ë…¼ë¸”ë¡œí‚¹ ì ìš©**: í”„ë¡œì„¸ìŠ¤ ìƒì„± ì˜¤ë²„í—¤ë“œ ì œê±°ë¡œ ì¶”ê°€ 20-30% ê°œì„ 

ì‚¬ìš©ì ëŒ€ê¸°ì‹œê°„ì„ í˜„ì €íˆ ì¤„ì¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ëŒ€ìš©ëŸ‰ ë¡œê·¸ íŒŒì¼ì„ ì½ëŠ” ê¸°ëŠ¥ì´ ì´ ì„œë²„ì˜ ì£¼ëª©ì ì´ë‹¤ ë³´ë‹ˆê¹Œ.. 
IO ë³‘ëª© ê°œì„ ì´ í•µì‹¬ ê°œì„ ì‚¬í•­ìœ¼ë¡œ ë³´ì„. 

ì‘ì—…ë°©í–¥ì´ë‘ ë¶€ì‘ìš© ê²€í† í•´ë³´ê³  7ì›” ì²«ì§¸ì£¼ê¹Œì§€ ê°œì„ í•´ë³´ê² ë‹¤. 


---
