# ğŸ“š ê°œë°œ ë„ì„œ ìŠ¤í„°ë”” í…œí”Œë¦¿

## ğŸ§  1. ì±…ì„ ì½ê¸° ì „ì—
- **ê¸°ëŒ€í•˜ëŠ” ì **: ë™ì‹œì„±ì— ëŒ€í•œ ìë°”ë ˆë²¨, ë ˆë””ìŠ¤ ë ˆë²¨ ë“± ìˆœì°¨ì ìœ¼ë¡œ ì´ë¡ ì ìœ¼ë¡œë§Œ ì•Œê³  ìˆëŠ” ìƒí™©ì¸ë° ê°€ëŠ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ë„ í•´ë³´ê³  ì‹¶ë‹¤..
- **ì•Œê³  ì‹¶ì€ ê°œë… / ì£¼ì œ**: ë™ì‹œì„± ì²˜ë¦¬ì— ëŒ€í•œ ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ì™€ ê³ ë ¤í•´ì•¼í•  ì ë“¤

---

## ğŸ“‚ 2. ë‚´ìš© ì •ë¦¬ (ìì‹ ì˜ ì–¸ì–´ë¡œ ìš”ì•½)

### ì„œë²„ì™€ ë™ì‹œ ì‹¤í–‰
- ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
  1. í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ë§ˆë‹¤ ìŠ¤ë ˆë“œë¥¼ í• ë‹¹
  2. ë¹„ë™ê¸° or ë…¼ë¸”ë¡œí‚¹ IOë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬ (ë¹„ë™ê¸°ì´ë”ë¼ë„ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥)
- ë™ì‹œì„±ì€ ì¼ë°˜ì ìœ¼ë¡œ ì˜ ë“œëŸ¬ë‚˜ì§€ ì•Šê³  ì˜ˆìƒì¹˜ ëª»í•œ ìˆœê°„ì— ë‚˜íƒ€ë‚˜ê¸° ë•Œë¬¸ì— ì˜ ì˜ì‹í•˜ê³  ê°œë°œí•´ì•¼ í•œë‹¤.

### ì˜ëª»ëœ ë°ì´í„° ê³µìœ ë¡œ ì¸í•œ ë¬¸ì œ ì˜ˆì‹œ

```java
public class PayService {
  private Long payId;

  public PayResp pay(PayRequest req) {
    this.payId = getPayId() //1ë‹¨ê³„
    saveTemp(this.payId, req);
    PayResp resp = sendPayData(this.payId, ...);
    applyResponse(resp);
    return resp;
  }

  public void applyResponse(PayResp resp) {
    PayData payData = createPayDataFromResp(resp); // 2ë‹¨ê³„
    updatePayData(this.payId, payData);
  }

```
**[ì¤‘ìš”]**
- ìŠ¤í”„ë§ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ìƒíƒœê°’ì„ ë˜ë„ë¡ ê°€ì§€ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŒ
- ë‹¤ë¥¸ ìŠ¤ë ˆë“œì™€ ê³µìœ í•˜ëŠ” ê°’ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆìŒ. ê°–ê²Œ ëœë‹¤ë©´,ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•œë‹¤.
- ì‚¬ë¡€, ë°°ì†¡ ë‹¨ê³„ë¡œì˜ ì „í™˜ê³¼ ê³ ê°ì˜ ì£¼ë¬¸ ì·¨ì†Œê°€ ë™ì‹œì— ë“¤ì–´ì˜¤ëŠ” ê²½ìš°ì— ëŒ€í•œ ì²˜ë¦¬. (ê²°ì œëŠ” ì·¨ì†Œí–ˆëŠ”ë°, ë¬¼ê±´ì´ ë°°ì†¡ë˜ë©´ ì•ˆë¨)

### í”„ë¡œì„¸ìŠ¤ ìˆ˜ì¤€ì—ì„œ ë™ì‹œ ì ‘ê·¼ ì œì–´
- ì ê¸ˆì„ ì‚¬ìš©í•˜ë©´ ê³µìœ  ìì›ì— ì ‘ê·¼í•˜ëŠ” ìŠ¤ë ˆë“œë¥¼ í•œë²ˆì— í•˜ë‚˜ë¡œ ì œí•œí•  ìˆ˜ ìˆìŒ (ì„ê³„ì˜ì—­)
- ë§Œì•½ì— ë™ì‹œì„±ì„ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ìë£Œí˜•ì„ ì‚¬ìš©í•˜ë©´, ë°ì´í„°ê°€ ìœ ì‹¤ë˜ê±°ë‚˜ ê°’ì´ ì˜ëª» ì„¤ì •ë  ìˆ˜ ìˆìŒ (ì¼ë¶€ ê°’ì´ nullë¡œ í• ë‹¹ë  ìˆ˜ ìˆìŒ)
- ReetrantLockdml ëŠ” í•œë²ˆì— í•œ ê°œì˜ ìŠ¤ë ˆë“œì—ë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë˜ì„œ ë‚˜ë¨¸ì§€ëŠ” ëŒ€ê¸°ë¥¼ í•´ì•¼í•¨.
- ì ê¸ˆ ì™¸ì—ë„ ë™ì‹œì„±ì„ í†µì œí•˜ê¸° ìœ„í•´ì„œ ì„¸ë§ˆí¬ì–´ì™€ ì½ê¸°ì“°ê¸° ì ê¸ˆì´ ìˆìŒ

#### ì„¸ë§ˆí¬ì–´
- ë™ì‹œì— ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ nê°œë¡œ ì œí•œí•  ìˆ˜ ìˆìŒ
- ì™¸ë¶€ ì—°ë™ ì„œë¹„ìŠ¤ ê°™ì€ ê²½ìš°ì— í•„ìš”.
- ì„¸ë§ˆí¬ì–´ì˜ êµ¬í˜„ì²´ëŠ” permitì´ë¼ê³  í‘œí˜„í•œë‹¤.

#### ì½ê¸° ì“°ê¸° ì ê¸ˆ
- **ì ê¸ˆì„ ì‚¬ìš©í•˜ë©´ ë™ì‹œì— ì½ê¸°ë„ ì•ˆëœë‹¤.** -> ë‹¨ìˆœ ì ê¸ˆì„ ì˜ë¯¸
- ì½ê¸° ì“°ê¸° ì ê¸ˆìœ¼ë¡œ ë¶„ë¦¬í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œ
- ì½ê¸°ëŠ” í•œë²ˆì— ì—¬ëŸ¬ ìŠ¤ë ˆë“œ ì ‘ê·¼ ê°€ëŠ¥, ì“°ê¸°ëŠ” í•œê°œ
- ì“°ê¸° ì ê¸ˆì„ íšë“í•˜ë©´ ì½ê¸° ì ê¸ˆì€ ëª¨ë‘ ëŒ€ê¸°ë¥¼ í•´ì•¼í•œë‹¤. ë°˜ëŒ€ì˜ ê²½ìš°ë„ ë§ˆì°¬ê°€ì§€

#### ì›ìì  íƒ€ì…
- ë§¤ë²ˆ ë½ì„ ì‚¬ìš©í•˜ëŠ” ê±´ CPUíš¨ìœ¨ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŒ
- AtomicInteger ì²˜ëŸ¼ ì´ëŸ° íƒ€ì„ì„ ì‚¬ìš©í•˜ë©´, ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ê³µìœ í•˜ëŠ” ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ
  
```java
lock.lock();
lock.unlock();
lock.readLock();
lock.writeLock();
try-finally
semaphore.acquire()
semaphore.release()
```

### DBì™€ ë™ì‹œì„±
- DBíŠ¸ëœì­ì…˜ì€ ì—¬ëŸ¬ ì¡°íšŒë‚˜ ì“°ê¸°ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ì—°ì‚°ìœ¼ë¡œ ë¬¶ëŠ”ë‹¤.
- DBëŠ” ëŒ€ë¶€ë¶„ ëª…ì‹œì  ì ê¸ˆì„ ì œê³µí•œë‹¤.

#### ì„ ì  ì ê¸ˆ(ë¹„ê´€ì  ë½)
- ë™ì¼í•œ ë ˆì½”ë“œì— ëŒ€í•´ í•œë²ˆì— í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ë§Œ í—ˆìš©í•œë‹¤.
- ë¹„ê´€ë½ì€ ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì„œ ë¹„ê´€ì ì´ë¼ê³  í‘œí˜„í•œë‹¤.
- ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ë¹„ê´€ì  ìƒí™©ì—ì„œ ë°°íƒ€ì  ë½ì„ ì‚¬ìš©í•œë‹¤.

```sql
SELECT * FROM í…Œì´ë¸” WHERE ì¡°ê±´ FOR UPDATE
```
- ë‘ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ë½ì„ í•˜ë‚˜ë¥¼ ì¡ê³  ê·¸ ë½ì´ ëë‚  ë•Œ ê¹Œì§€ ëŒ€ê¸°í•œë‹¤.
- ê²°êµ­ì—ëŠ” ì¤‘ìš”í•œ ê±´ ìˆœì„œê°€ ì ìš©ë˜ì–´ ìˆëŠ”ê°€?
  
#### ë¹„ì„ ì  ì ê¸ˆ(ë‚™ê´€ì  ë½)
- ê°’ì„ ë¹„êµí•´ì„œ ìˆ˜ì •í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. (ì¿¼ë¦¬ ì‹¤í–‰ì„ ë§‰ì§€ ì•ŠìŒ)
- ì¿¼ë¦¬ì˜ ì„±ê³µ ê°€ëŠ¥ì„±ì´ ë†’ìŒ
- ëª…ì‹œì ìœ¼ë¡œ ì ê¸ˆì„ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ, ë°ì´í„°ë¥¼ ì¡°íšŒí•œ ì‹œì ì˜ ê°’ê³¼ ìˆ˜ì •í•˜ëŠ” ì‹œì ì˜ ê°’ì´ ê°™ì€ì§€ ë¹„êµí•œë‹¤.

```sql
SELECT _,VERSION FROM í…Œì´ë¸” WHERE id = ì•„ì´ë””

UPDATE í…Œì´ë¸” SET _, version = version+1
where id = ì•„ì´ë”” and version = 1ì—ì„œ ì¡°íšŒí•œ version ê°’
```
- ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ë¨¼ì € ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë©´ versionê°’ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— Updateê²°ê³¼ê°€ 0ê±´ì´ ëœë‹¤. => ë¡¤ë°± ëŒ€ìƒ
- UPDATEê²°ê³¼ê°€ 0ë³´ë‹¤ í¬ë©´,ì¡°íšŒí•œ ì´í›„ ë²„ì „ ê°’ì´ ë°”ë€Œì§€ ì•Šì€ ê²ƒ. => ë°ì´í„° ë³€ê²½ì— ì„±ê³µ

#### ì™¸ë¶€ ì—°ë™ê³¼ ì ê¸ˆ
- ì™¸ë¶€ ì—°ë™ì‹œì—ëŠ” ë¹„ê´€ë½ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŒ
- ê²°ì œ ì‹œìŠ¤í…œì€ ì·¨ì†Œë˜ì–´(ì·¨ì†Œìƒíƒœ ë³€ê²½ íŠ¸ëœì­ì…˜ ë™ì‘) íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±ë˜ì–´ë²„ë¦´ ìˆ˜ ìˆìŒ (ì·¨ì†Œë˜ì§€ ëª»í•˜ê³  ê²°ì œ ìƒíƒœê°€ ìœ ì§€ë˜ëŠ” ê²ƒ)

#### ì¦ë¶„ ì¿¼ë¦¬
- ì°¸ì—¬ì ìˆ˜ë¥¼ ëŠ˜ë¦¬ëŠ” ë¡œì§ë„ ì½”ë“œ ìƒì—ì„œ ë§ê³  ì¿¼ë¦¬ìƒì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ í•´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²• (DBì˜ ì›ìì  ì—°ì‚°ì„ ë”°ë¼ê°€ê¸°)

### ì ê¸ˆ ì‚¬ìš©ì‹œ ì£¼ì˜ ì‚¬í•­
1. ì ê¸ˆ ì‚¬ìš©í›„ì—ëŠ” ê¼­ ë‹«ì•„ì£¼ê¸° (try-finally)
2. ëŒ€ê¸°ì‹œê°„ ì§€ì •í•˜ê¸° (ë½ì„ ì–¼ë§ˆë‚˜ ê¸°ë‹¤ë¦´ì§€ ì§€ì •í•´ë‘ê³  ì‚¬ìš©í•˜ê¸°)
3. ë°ë“œë½ í”¼í•˜ê¸° (ëŒ€ê¸° ì‹œê°„ì„ ì œí•œ, ê·¸ë¦¬ê³  ìˆœì„œë¥¼ ì§€ì •í•˜ê¸° or ìš°ì„ ìˆœìœ„ë¥¼ ì§€ì •í•˜ê¸°)

### ë‹¨ì¼ ìŠ¤ë ˆë“œë¡œ ì²˜ë¦¬í•˜ê¸°
- ë‘ ìŠ¤ë ˆë“œ ê°„ì— ë°ì´í„° ê³µìœ ê°€ í•„ìš”í•˜ë©´ ì½œë°±ì´ë‚˜ íì™€ ê°™ì€ ìˆ˜ë‹¨ì„ ì‚¬ìš©í•´ì„œ ë³µì œë³¸ or ë¶ˆë³€ê°’ì„ ê³µìœ í•œë‹¤.
- ë‹¨ì¼ ìŠ¤ë ˆë“œë¡œ ì²˜ë¦¬í•˜ë©´ ë™ì‹œì„±ì—ì„œ ììœ ë¡­ê² ì§€ë§Œ, êµ¬ì¡°ê°€ ë³µì¡í•´ì§ˆ ìˆ˜ ìˆìŒ

## ğŸ’¬ 3. ì´ì•¼ê¸°í•˜ê³  ì‹¶ì€ ì§ˆë¬¸ / í¬ì¸íŠ¸
- ê¸°ë³¸ì ìœ¼ë¡œ ìŠ¤í”„ë§ì€ ì‹±ê¸€í†¤ì´ê¸° ë•Œë¬¸ì— ê° ìš”ì²­ë§ˆë‹¤ ë³„ë„ì˜ ìŠ¤ë ˆë“œë¥¼ í• ë‹¹ë°›ì•„ì„œ ì²˜ë¦¬í•¨.(Transactional - ThreadLocal)
- í•˜ì§€ë§Œ, í•„ë“œê°’ì²˜ëŸ¼ ì„œë¡œ ê³µìœ í•˜ëŠ” ê´€ê³„ì˜ ê°’ì— ëŒ€í•´ì„œëŠ” ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ

## â“ ì§ˆë¬¸:
### ReetrantLock vs syncronized vs Condition 
- ìˆ˜ë™ìœ¼ë¡œ ì ê¸ˆì˜ì—­ì˜ ì‹œì‘ì ê³¼ ëì ì„ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ê°ì²´ì„
- lock, unlockìœ¼ë¡œ ë½ì„ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.

| ReetrantLock | syncronized | 
| ---------- | ----------- | 
| íšë“í•œ ìŠ¤ë ˆë“œê°€ í•´ë‹¹ ë½ì„ ë‹¤ì‹œ íšë“ ê°€ëŠ¥ | í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ì´ë¯¸ ë¸”ë¡ëœ ì˜ì—­ì„ ì¬ì§„ì… ê°€ëŠ¥ | 
| ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥ | ëœ ìœ ì—°í•¨ | 
| ì¡°ê±´ ë³€ìˆ˜ë¥¼ ì§€ì›í•œë‹¤. (Condition) | ì§€ì› ì•ˆí•¨ |
| tryLock ë©”ì„œë“œë¡œ ë¸”ë¡œí‚¹ì„ í”¼í•  ìˆ˜ ìˆìŒ | ë¸”ë¡œí‚¹ ë°œìƒí•¨ |
| ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ìœ ì—°ì„± ì œê³µ | ì˜ˆì™¸ì²˜ë¦¬ ì‹œ lockì„ ìë™ìœ¼ë¡œ í•´ì œí•¨ |

#### Condition
- íŠ¹ì • ìŠ¤ë ˆë“œê°€ ê°ì²´ì˜ ë½ì„ ì˜¤ë«ë™ì•„ ê°€ì§€ì§€ ì•Šë„ë¡ í•˜ëŠ” ë©”ì„œë“œ
- ì‘ì—…ì˜ ìˆœì„œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ë„ ê°€ëŠ¥í• ë“¯?
```java
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.ReentrantLock;

public class SimpleReentrantLockConditionExample {
    public static void main(String[] args) {
        Test test = new Test();
        Thread thread1 = new Thread(() -> test.print("Thread 1"));
        Thread thread2 = new Thread(() -> test.print("Thread 2"));

        thread1.start();
        thread2.start();
    }
}

class Test {
    private ReentrantLock lock = new ReentrantLock();
    private Condition condition = lock.newCondition();
    private boolean isThread1Turn = true;

    public void print(String message) {
        lock.lock();
        try {
            while ((message.equals("Thread 1") && !isThread1Turn) || (message.equals("Thread 2") && isThread1Turn)) {
                condition.await();
            }
            System.out.println(message + " is printing.");
            isThread1Turn = !isThread1Turn;
            condition.signal();
        } catch (InterruptedException e) {
        	// ...
        } finally {
            lock.unlock();
        }
    }
}

/* ì¶œë ¥ ê²°ê³¼

Thread 1 is printing.
Thread 2 is printing.
Thread 1 is printing.
Thread 2 is printing.
Thread 1 is printing.
... (ì´í•˜ ìƒëµ)

```

### ê°€ì‹œì„± volatile
- íŠ¹ì • ìŠ¤ë ˆë“œê°€ ê°’ì„ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë“¤ì´ ì¦‰ì‹œ ë³€ê²½ëœ ê°’ì„ ë³¼ ìˆ˜ ìˆë„ë¡ ë³´ì¥í•˜ëŠ” ê²ƒì„ ì˜ë¯¸
- ì¦‰, CPU ìºì‹œì— ì €ì¥ëœ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  í•­ìƒ ë©”ì¸ ë©”ëª¨ë¦¬ì—ì„œ ê°’ì„ ì½ê³  ì“°ë„ë¡ í•˜ì—¬ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ” ê²ƒ
- ì½ê¸°ì—ì„œ ê°€ì‹œì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©

###  CAS (Compare and swap)
 <img width="508" alt="ìŠ¤í¬ë¦°ìƒ· 2025-06-15 ì˜¤í›„ 9 59 11" src="https://github.com/user-attachments/assets/f4ad025b-2df0-49c3-906e-3beca9dfff26" />
- ë³€ìˆ˜ëŠ” ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ìŠ¤ë˜ë“œì˜ ìŠ¤íƒ(ìºì‹œ) ì— ì €ì¥ë¨.
- ìŠ¤ë ˆë“œì— ì €ì¥ëœ ê°’ê³¼ ë©”ëª¨ë¦¬ì— ì €ì¥ëœ ê°’ì„ ë¹„êµí•´ì„œ ê°’ì´ ê°™ìœ¼ë©´ ìƒˆë¡œìš´ ê°’ìœ¼ë¡œ ì¹˜í™˜í•œë‹¤.
  ì˜ˆì‹œ:
	â€¢	ìŠ¤ë ˆë“œ Aê°€ `value = 5`ë¥¼ ì½ê³  `5 + 1 = 6`ìœ¼ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.
	â€¢	CASëŠ” `value`ê°€ ì—¬ì „íˆ `5`ì¸ì§€ í™•ì¸í•œ í›„ `6`ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
	â€¢	ë§Œì•½ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì´ë¯¸ `value`ë¥¼ `6`ìœ¼ë¡œ ë³€ê²½í–ˆë‹¤ë©´, CASëŠ” ì‹¤íŒ¨í•˜ê³  ìŠ¤ë ˆë“œ AëŠ” ì¬ì‹œë„í•©ë‹ˆë‹¤.
- ë½ì„ ê±¸ì§€ ì•Šê³  ë³€ìˆ˜ë§ˆë‹¤ ë™ê¸°í™”ë¥¼ í•´ ê°’ì´ ì‹¸ë‹¤

### ë¶ˆë³€ì€ ì–´ë””ê¹Œì§€ í•´ì•¼í• ê¹Œ
- ë‹¤ë“¤ ë¶ˆë³€ì„ ë§Œë“œëŠ” ê¸°ì¤€ì´ ìˆìœ¼ì‹ ì§€?

### UPDATE ê°€ 1ë³´ë‹¤ í° ê²½ìš°?
- ì¼ë¶€ DBì—ì„œëŠ” 1 ì´ìƒìœ¼ë¡œ í™•ì¸í•˜ê¸° ë•Œë¬¸ì´ë˜

### ë ˆë””ìŠ¤ ë¶„ì‚°ë½
- ë‹¤ì¤‘ ì„œë²„ì—ì„œ ê³µìœ ë˜ëŠ” ë°ì´í„°ë¥¼ ì œì–´
#### Lettuceë¥¼ ì´ìš©í•œ Spin Lock
- lockì„ ì¡ëŠ”ë‹¤ : lock íšë“ ê°€ëŠ¥í•œì§€ í™•ì¸, ê°€ëŠ¥í•˜ë©´ lockì„ íšë“í•˜ëŠ” í–‰ìœ„ê°€ ì›ìì ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ì•¼ í•¨
- redisì˜ setnxëŠ” í‚¤ê°’ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ë¥¼ setí•´ ê°œë°œìê°€ ì§ì ‘ lockí”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŒ
- í•˜ì§€ë§Œ ë¬´í•œë£¨í”„ë¡œ ë½ ì ìœ ë¥¼ ì‹œë„í•˜ê¸° ë•Œë¬¸ì— ë¶€í•˜ê°€ ìƒê¸¸ ìˆ˜ ìˆê³  ì¼ë¶€ëŸ¬ sleepì„ ì‹œë„í•´ë„ ë¹„íš¨ìœ¨ì´ ë°œìƒí•¨
- ë‹¤ë¥¸ ë½ì˜ ë¬´í•œ ëŒ€ê¸°ìƒíƒœê°€ ì´ë£¨ì–´ì§ˆ ìˆ˜ë„ ìˆìŒ

+```java
  @RequiredArgsConstructor
@Component
public class RedisRepository {

	private final RedisTemplate<String, String> lockRedisTemplate;

	public Boolean lock(long key) {
      String lockKey = lockKeyGen(key);

      return lockRedisTemplate.opsForValue()
              .setIfAbsent(lockKey, "lock", Duration.ofMillis(3000L));
  }

  public Boolean unlock(long key) {
      return lockRedisTemplate.delete(lockKeyGen(key));
  }
	
	private String lockKeyGen(long key) {
      return "lock:" + key;
  }
}
```
#### Redisson ë¶„ì‚° ë½
- Lock ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§€ì›í•œë‹¤. ê°œë°œìê°€ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ë˜ì–´ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
- pub/sub ì„ ì´ìš©í•´ ë½ì´ í•´ì œë˜ë©´ ë½ì„ subscribeí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë½ì´ í•´ì œëœ ì‹ í˜¸ë¥¼ ë°›ê³  ë½ íšë“ì„ ì‹œë„í•  ìˆ˜ ìˆìŒ

[ì°¸ì¡° ë§í¬](https://helloworld.kurly.com/blog/distributed-redisson-lock/)

---

## ğŸŒŸ 5. ì „ì²´ ë¦¬ë·°

- **ë³„ì  í‰ê°€** (â­ï¸ 5ì  ë§Œì ): `â­ï¸â­ï¸â­ï¸â­ï¸`
- **ì±…ì— ëŒ€í•œ ì´í‰**: ë™ì‹œì„± ì²˜ë¦¬ ë³µê¸°ê°€ ê°€ëŠ¥í•˜ë‹¤.. í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì§œë³´ë„ë¡ í•˜ì..
- **ì´ ì±…ì„ ì¶”ì²œí•œë‹¤ë©´ ì–´ë–¤ ì‚¬ëŒì—ê²Œ?**
- 
